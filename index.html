<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MaiGacha</title>
  <link rel="icon" type="image/x-icon" href="/Images/Favicon.png">
  <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: url('Images/maimaibg.png') center/cover no-repeat fixed;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      overflow: hidden;
    }

    .container {
      text-align: center;
      width: 400px;
      backdrop-filter: blur(100px);
      background: rgba(255, 255, 255, 0.3);
      padding: 3rem 4rem;
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.15);
      transition: opacity 0.5s ease;
    }

    h1, p {
      color: #ceaaf6;
      text-shadow: -1px -1px 0 #fff, 1px -1px 0 #fff,
                   -1px 1px 0 #fff, 1px 1px 0 #fff;
    }

    button {
      padding: 0.75rem 2rem;
      font-size: 1rem;
      color: #ceaaf6;
      background: #fff;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    button:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.25);
    }

    img {
      cursor: pointer;
    }

    #volumeControl {
      position: fixed;
      bottom: 20px;
      left: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
      background: rgba(255, 255, 255, 0.3);
      padding: 8px 12px;
      border-radius: 12px;
      backdrop-filter: blur(10px);
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }

    #volumeSlider {
      display: none;
    }

    #volumeControl:hover #volumeSlider {
      display: block;
    }

    #volumeIcon {
      width: 24px;
      height: 24px;
      cursor: pointer;
    }

    @keyframes jump {
      0%   { transform: translateY(0); }
      30%  { transform: translateY(-30px); }
      60%  { transform: translateY(0); }
      100% { transform: translateY(0); }
    }

    .particle {
      position: absolute;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #fff;
      pointer-events: none;
      animation: explode 0.6s ease-out forwards;
    }

    @keyframes explode {
      0%   { opacity: 1; transform: scale(1); }
      100% { opacity: 0; transform: translate(var(--dx), var(--dy)) scale(0.5); }
    }

    #gachaModal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      justify-content: center;
      align-items: center;
      background: rgba(0,0,0,0.6);
      z-index: 999;
    }

    #bannerSelector {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-right: 30px;
      transform: rotate(-3deg);
    }

    .bannerBtn {
      padding: 10px 20px;
      font-size: 1rem;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      background: #fff;
      color: #ceaaf6;
      box-shadow: 2px 4px 10px rgba(0,0,0,0.2);
      transition: background 0.3s;
    }

    .bannerBtn:hover {
      background: #f0e8ff;
    }

    #gachaScreen {
      position: relative;
      background: #fff;
      padding: 2rem;
      border-radius: 20px;
      display: flex;
      align-items: center;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      transform: rotate(2deg);
    }

    #bannerImage {
      width: 700px;
      height: 400px;
      border-radius: 15px;
      margin-right: 30px;
    }

    .spinPanel {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .spinPanel p {
      font-size: 1.25rem;
      margin: 0;
    }

    .spinPanel button {
      padding: 10px 20px;
      border: none;
      border-radius: 10px;
      font-size: 1rem;
      cursor: pointer;
      background: #ceaaf6;
      color: white;
      transition: background 0.3s;
    }

    .spinPanel button:hover {
      background: #b788e6;
    }

    #closeModal {
      position: absolute;
      top: 15px;
      right: 20px;
      font-size: 1.5rem;
      background: none;
      border: none;
      cursor: pointer;
    }


    #gachaModalContent {
      border-radius: 20px;
      padding: 2rem;
      text-align: center;
      max-width: 400px;
      position: relative;
    }

    @keyframes spinSlot {
      0% { transform: translateX(0); }
      80% { transform: translateX(-240px); }
      100% { transform: translateX(0); }
    }
    .slot.spin {
      animation: spinSlot 1s ease-in-out;
    }

    #resultOverlay {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(0,0,0,0.8);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    #resultImage {
      width: 200px;
      animation: jump 1s ease;
    }

    @media (max-width: 768px) {
    .container {
      width: 90%;
      padding: 2rem;
    }

    #bannerSelector {
      flex-direction: row;
      flex-wrap: wrap;
      justify-content: center;
      margin: 0 0 20px 0;
      transform: none;
    }

    .bannerBtn {
      font-size: 0.9rem;
      padding: 8px 12px;
    }

    #gachaScreen {
      flex-direction: column;
      padding: 1.5rem;
      transform: none;
      width: 90%;
    }

    #bannerImage {
      width: 100%;
      height: auto;
      margin: 0 0 20px 0;
    }

    .spinPanel p {
      font-size: 1rem;
    }

    .spinPanel button {
      width: 100%;
      font-size: 0.95rem;
    }

    #volumeControl {
      flex-direction: column;
      bottom: 10px;
      left: 10px;
      gap: 5px;
      padding: 6px;
    }

    #volumeSlider {
      width: 80px;
    }

    #resultImage {
      width: 150px;
    }
  }

  @media (max-width: 480px) {
    .container {
      padding: 1.5rem;
    }

    h1 {
      font-size: 1.5rem;
    }

    p {
      font-size: 1rem;
    }

    button {
      font-size: 0.9rem;
      padding: 0.5rem 1rem;
    }
  }

  </style>
</head>
<body>
  <audio id="clickSound" src="Sounds/tap.wav" preload="auto"></audio>
  <audio id="bgMusic" src="Sounds/None.mp3" autoplay loop></audio>

  <div class="container" id="page1">
    <h1>MaiGacha</h1>
    <p>Click here to start your MaiGacha adventure!</p><br>
    <button onclick="transitionToNext()">Get Started</button>
  </div>

  <div id="volumeControl">
    <img src="Images/speaker.png" alt="Volume" id="volumeIcon" />
    <input type="range" id="volumeSlider" min="0" max="1" step="0.01" value="1" />
  </div>

  <div id="gachaModal">
    <div id="bannerSelector">
      <button class="bannerBtn">Maimai</button>
      <button class="bannerBtn">7sRef</button>
      <button class="bannerBtn">Metropolis</button>
    </div>

    <div id="gachaScreen">
      <img src="Images/maimaibanner.jpg" id="bannerImage" alt="Gacha Banner" />
      <div class="spinPanel">
        <p><strong>1x Spin:</strong> 10 clicks</p>
        <button id="spinBtn1x">Spin ×1</button>
        <p><strong>10x Spin:</strong> 100 clicks</p>
        <button id="spinBtn10x">Spin ×10</button>
      </div>
      <button id="closeModal">×</button>
    </div>

    <div id="resultOverlay">
      <img id="resultImage" src="Images/Ras.webp" alt="Result">
    </div>
  </div>

  <script>
    let count = 0;
    let started = false;

    const sound = document.getElementById("clickSound");
    const volumeSlider = document.getElementById("volumeSlider");
    const bgMusic = document.getElementById("bgMusic");
    bgMusic.volume = 0.25;

    volumeSlider.addEventListener("input", () => {
      sound.volume = volumeSlider.value;
    });

    function transitionToNext() {
      const container = document.getElementById("page1");
      container.style.opacity = "0";

      setTimeout(() => {
        container.innerHTML = `
          <h1 id="clickText">Click to start</h1>
          <img
            src="Images/Derakkuma.webp"
            alt="Mai Character"
            id="clickerImage"
            style="width: 150px; margin-top: 20px;"
          /><br><br>
          <button id="gachaBtn" style="margin-top: 20px; width: 200px; padding: 0.5rem 1.5rem; border-radius: 20px; cursor: pointer;">
            Gacha
          </button>
        `;

        container.style.opacity = "1";

        const text = document.getElementById("clickText");
        const clickerImage = document.getElementById("clickerImage");
        const gachaBtn = document.getElementById("gachaBtn");
        const gachaModal = document.getElementById("gachaModal");
        const closeModal = document.getElementById("closeModal");
        const spinBtn1x = document.getElementById("spinBtn1x");
        const spinBtn10x = document.getElementById("spinBtn10x");

        const characters = ["Ras", "Shama", "Chiffon"];
        const resultImg = document.getElementById("resultImage");
        const overlay = document.getElementById("resultOverlay");

        function spinGacha(times) {
          const slots = document.querySelectorAll('.slot');

          let spinCount = 0;

          function showSpinResult() {
            const randChar = characters[Math.floor(Math.random() * characters.length)];
            resultImg.src = `Images/${randChar}.webp`;
            overlay.style.display = "flex";

            setTimeout(() => {
              overlay.style.display = "none";
              spinCount++;

              if (spinCount < times) {
                setTimeout(showSpinResult, 300);
              }
            }, 1000);
          }

          // Start spin animation
          slots.forEach(slot => {
            slot.classList.add('spin');
            setTimeout(() => slot.classList.remove('spin'), 1000);
          });

          // Delay before showing result
          setTimeout(() => {
            spinCount = 0;
            showSpinResult();
          }, 1000);
        }

        spinBtn1x.addEventListener("click", () => {
          if (count >= 10) {
            count -= 10;
            text.textContent = `Clicks: ${count}`;
            spinGacha(1);
          } else {
            alert("Not enough clicks for 1x spin!");
          }
        });

        spinBtn10x.addEventListener("click", () => {
          if (count >= 100) {
            count -= 100;
            text.textContent = `Clicks: ${count}`;
            spinGacha(10);
          } else {
            alert("Not enough clicks for 10x spin!");
          }
        });

        clickerImage.addEventListener("click", () => {
          count++;
          text.textContent = `Clicks: ${count}`;
          sound.currentTime = 0;
          sound.play();

          clickerImage.style.animation = "jump 0.3s";
          setTimeout(() => (clickerImage.style.animation = ""), 300);
        });

        gachaBtn.addEventListener("click", () => {
          gachaModal.style.display = "flex";
        });

        closeModal.addEventListener("click", () => {
          gachaModal.style.display = "none";
        });
      }, 500);
    }

    const volumeIcon = document.getElementById("volumeIcon");
    let previousVolume = volumeSlider.value;

    volumeSlider.addEventListener("input", () => {
      const vol = volumeSlider.value;
      sound.volume = vol;
      bgMusic.volume = vol * 0.5;
      const muted = vol == 0;
      sound.muted = muted;
      bgMusic.muted = muted;
      volumeIcon.src = muted ? "Images/muted.png" : "Images/speaker.png";
    });

    volumeIcon.addEventListener("click", () => {
      const isMuted = sound.muted || volumeSlider.value == 0;
      if (isMuted) {
        sound.muted = false;
        bgMusic.muted = false;
        volumeSlider.value = previousVolume || 1;
        sound.volume = volumeSlider.value;
        bgMusic.volume = volumeSlider.value * 0.5;
        volumeIcon.src = "Images/speaker.png";
      } else {
        sound.muted = true;
        bgMusic.muted = true;
        previousVolume = volumeSlider.value;
        volumeSlider.value = 0;
        sound.volume = 0;
        bgMusic.volume = 0;
        volumeIcon.src = "Images/muted.png";
      }
    });
  </script>
</body>

</html>
